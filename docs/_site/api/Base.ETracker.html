<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.47">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>base.etracker – DeToX</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="api/_styles-quartodoc.css">
<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../resources/logo/full_logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">DeToX</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../GettingStarted.html"> 
<span class="menu-text">Getting Started</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-vignettes" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Vignettes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-vignettes">    
        <li>
    <a class="dropdown-item" href="../Calibration.html">
 <span class="dropdown-text">Calibration Guide</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../GazeContingent.html">
 <span class="dropdown-text">Gaze Contingent Experiments</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../DataFormats.html">
 <span class="dropdown-text">Undertanding data formats</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../api/index.html" aria-current="page"> 
<span class="menu-text">Reference</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://twitter.com" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://code.com">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://bugs.com">
            Report a Bug
            </a>
          </li>
      </ul>
    </div>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../api/Base.ETracker.html">Some functions</a></li><li class="breadcrumb-item"><a href="../api/Base.ETracker.html">Base.ETracker</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../api/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Function reference</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Some functions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../api/Base.ETracker.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Base.ETracker</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#DeToX.Base.ETracker" id="toc-DeToX.Base.ETracker" class="nav-link active" data-scroll-target="#DeToX.Base.ETracker">Base.ETracker</a>
  <ul class="collapse">
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a>
  <ul class="collapse">
  <li><a href="#DeToX.Base.ETracker.calibrate" id="toc-DeToX.Base.ETracker.calibrate" class="nav-link" data-scroll-target="#DeToX.Base.ETracker.calibrate">calibrate</a></li>
  <li><a href="#DeToX.Base.ETracker.close" id="toc-DeToX.Base.ETracker.close" class="nav-link" data-scroll-target="#DeToX.Base.ETracker.close">close</a></li>
  <li><a href="#DeToX.Base.ETracker.gaze_contingent" id="toc-DeToX.Base.ETracker.gaze_contingent" class="nav-link" data-scroll-target="#DeToX.Base.ETracker.gaze_contingent">gaze_contingent</a></li>
  <li><a href="#DeToX.Base.ETracker.get_average_gaze" id="toc-DeToX.Base.ETracker.get_average_gaze" class="nav-link" data-scroll-target="#DeToX.Base.ETracker.get_average_gaze">get_average_gaze</a></li>
  <li><a href="#DeToX.Base.ETracker.get_info" id="toc-DeToX.Base.ETracker.get_info" class="nav-link" data-scroll-target="#DeToX.Base.ETracker.get_info">get_info</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#after-connecting-to-the-tracker" id="toc-after-connecting-to-the-tracker" class="nav-link" data-scroll-target="#after-connecting-to-the-tracker">After connecting to the tracker</a></li>
  <li><a href="#just-before-starting-to-record-data" id="toc-just-before-starting-to-record-data" class="nav-link" data-scroll-target="#just-before-starting-to-record-data">Just before starting to record data</a>
  <ul class="collapse">
  <li><a href="#DeToX.Base.ETracker.load_calibration" id="toc-DeToX.Base.ETracker.load_calibration" class="nav-link" data-scroll-target="#DeToX.Base.ETracker.load_calibration">load_calibration</a></li>
  <li><a href="#DeToX.Base.ETracker.record_event" id="toc-DeToX.Base.ETracker.record_event" class="nav-link" data-scroll-target="#DeToX.Base.ETracker.record_event">record_event</a></li>
  <li><a href="#DeToX.Base.ETracker.save_calibration" id="toc-DeToX.Base.ETracker.save_calibration" class="nav-link" data-scroll-target="#DeToX.Base.ETracker.save_calibration">save_calibration</a></li>
  <li><a href="#DeToX.Base.ETracker.save_data" id="toc-DeToX.Base.ETracker.save_data" class="nav-link" data-scroll-target="#DeToX.Base.ETracker.save_data">save_data</a></li>
  <li><a href="#DeToX.Base.ETracker.show_status" id="toc-DeToX.Base.ETracker.show_status" class="nav-link" data-scroll-target="#DeToX.Base.ETracker.show_status">show_status</a></li>
  <li><a href="#DeToX.Base.ETracker.start_recording" id="toc-DeToX.Base.ETracker.start_recording" class="nav-link" data-scroll-target="#DeToX.Base.ETracker.start_recording">start_recording</a></li>
  <li><a href="#DeToX.Base.ETracker.stop_recording" id="toc-DeToX.Base.ETracker.stop_recording" class="nav-link" data-scroll-target="#DeToX.Base.ETracker.stop_recording">stop_recording</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="DeToX.Base.ETracker" class="level1">
<h1>Base.ETracker</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Base.ETracker(win, <span class="bu">id</span><span class="op">=</span><span class="dv">0</span>, simulate<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Tobii controller for infant research.</p>
<p>The TobiiController class is a simple Python wrapper around the Tobii Pro SDK for use in infant research. It provides convenience methods for starting/stopping gaze data recording and saving the data to a file.</p>
<p>The TobiiController class is designed to be used with the PsychoPy package, which is a popular Python library for creating psychology experiments. It is compatible with the Tobii Pro SDK version 3.0 or later.</p>
<p>The TobiiController class provides the following features:</p>
<pre><code>- Starting and stopping recording of gaze data
- Saving the recorded data to a file
- Running a calibration procedure
- Loading a calibration from a file
- Running a recording procedure
- Stopping the recording procedure</code></pre>
<p>The TobiiController class is designed to be easy to use and provides a minimal interface for the user to interact with the Tobii Pro SDK.</p>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#DeToX.Base.ETracker.calibrate">calibrate</a></td>
<td>Run the infant-friendly calibration procedure.</td>
</tr>
<tr class="even">
<td><a href="#DeToX.Base.ETracker.close">close</a></td>
<td>Clean shutdown of ETracker instance.</td>
</tr>
<tr class="odd">
<td><a href="#DeToX.Base.ETracker.gaze_contingent">gaze_contingent</a></td>
<td>Initialize real-time gaze buffer for contingent applications.</td>
</tr>
<tr class="even">
<td><a href="#DeToX.Base.ETracker.get_average_gaze">get_average_gaze</a></td>
<td>Compute smoothed gaze position from recent samples.</td>
</tr>
<tr class="odd">
<td><a href="#DeToX.Base.ETracker.get_info">get_info</a></td>
<td>Displays information about the connected eye tracker or simulation settings.</td>
</tr>
<tr class="even">
<td><a href="#DeToX.Base.ETracker.load_calibration">load_calibration</a></td>
<td>Loads calibration data from a file and applies it to the eye tracker.</td>
</tr>
<tr class="odd">
<td><a href="#DeToX.Base.ETracker.record_event">record_event</a></td>
<td>Record timestamped experimental event during data collection.</td>
</tr>
<tr class="even">
<td><a href="#DeToX.Base.ETracker.save_calibration">save_calibration</a></td>
<td>Save the current calibration data to a file.</td>
</tr>
<tr class="odd">
<td><a href="#DeToX.Base.ETracker.save_data">save_data</a></td>
<td>Save buffered gaze and event data to file with optimized processing.</td>
</tr>
<tr class="even">
<td><a href="#DeToX.Base.ETracker.show_status">show_status</a></td>
<td>Real-time visualization of participant’s eye position in track box.</td>
</tr>
<tr class="odd">
<td><a href="#DeToX.Base.ETracker.start_recording">start_recording</a></td>
<td>Begin gaze data recording session.</td>
</tr>
<tr class="even">
<td><a href="#DeToX.Base.ETracker.stop_recording">stop_recording</a></td>
<td>Stop gaze data recording and finalize session.</td>
</tr>
</tbody>
</table>
<section id="DeToX.Base.ETracker.calibrate" class="level3">
<h3 class="anchored" data-anchor-id="DeToX.Base.ETracker.calibrate">calibrate</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Base.ETracker.calibrate(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    calibration_points,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    infant_stims,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    shuffle<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    audio<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    anim_type<span class="op">=</span><span class="st">'zoom'</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    save_calib<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    num_samples<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Run the infant-friendly calibration procedure.</p>
<p>Automatically selects the calibration method based on operating mode (real eye tracker vs.&nbsp;simulation). Uses animated stimuli and optional audio to engage infants during calibration.</p>
<section id="parameters" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 76%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>calibration_points</td>
<td>list[tuple[float, float]]</td>
<td>Target locations in PsychoPy coordinates (e.g., height units). Typically 5�9 points distributed across the screen.</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>infant_stims</td>
<td>list[str]</td>
<td>Paths to engaging image files for calibration targets (e.g., animated characters, colorful objects).</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td>shuffle</td>
<td>bool</td>
<td>Whether to randomize stimulus presentation order. Default True.</td>
<td><code>True</code></td>
</tr>
<tr class="even">
<td>audio</td>
<td>psychopy.sound.Sound | None</td>
<td>Attention-getting sound to play during calibration. Default None.</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td>anim_type</td>
<td>(zoom, trill)</td>
<td>Animation style for the stimuli. Default ‘zoom’.</td>
<td><code>'zoom'</code></td>
</tr>
<tr class="even">
<td>save_calib</td>
<td>bool | str</td>
<td>Controls saving of calibration after a successful run: - False: do not save (default) - True: save using default naming (timestamped) - str: save to this filename; if it has no extension, ‘.dat’ is added.</td>
<td><code>False</code></td>
</tr>
<tr class="odd">
<td>num_samples</td>
<td>int</td>
<td>Samples per point in simulation mode. Default 5.</td>
<td><code>5</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns">Returns</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 79%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>bool</td>
<td>True if calibration completed successfully, False otherwise.</td>
</tr>
</tbody>
</table>
</section>
<section id="notes" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes">Notes</h4>
<ul>
<li>Real mode uses Tobii’s calibration with result visualization.</li>
<li>Simulation mode uses mouse position to approximate the process.</li>
<li>If in simulation mode, any save request is safely skipped with a warning.</li>
</ul>
</section>
</section>
<section id="DeToX.Base.ETracker.close" class="level3">
<h3 class="anchored" data-anchor-id="DeToX.Base.ETracker.close">close</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Base.ETracker.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Clean shutdown of ETracker instance.</p>
<p>Automatically stops any active recording session and performs necessary cleanup. Called automatically on program exit via atexit.</p>
</section>
<section id="DeToX.Base.ETracker.gaze_contingent" class="level3">
<h3 class="anchored" data-anchor-id="DeToX.Base.ETracker.gaze_contingent">gaze_contingent</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Base.ETracker.gaze_contingent(N<span class="op">=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Initialize real-time gaze buffer for contingent applications.</p>
<p>Sets up rolling buffer to store recent gaze coordinates for immediate processing during experiments. Enables smooth gaze estimation and real-time gaze-contingent paradigms.</p>
<section id="parameters-1" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-1">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 76%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>N</td>
<td>int</td>
<td>Number of recent gaze samples to buffer. Buffer holds coordinate pairs from both eyes.</td>
<td><code>5</code></td>
</tr>
</tbody>
</table>
</section>
<section id="raises" class="level4 doc-section doc-section-raises">
<h4 class="doc-section doc-section-raises anchored" data-anchor-id="raises">Raises</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>TypeError</td>
<td>If N is not an integer.</td>
</tr>
</tbody>
</table>
</section>
<section id="examples" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples">Examples</h4>
<p>tracker.gaze_contingent(10) # Buffer last 10 samples pos = tracker.get_average_gaze() # Get smoothed position</p>
</section>
</section>
<section id="DeToX.Base.ETracker.get_average_gaze" class="level3">
<h3 class="anchored" data-anchor-id="DeToX.Base.ETracker.get_average_gaze">get_average_gaze</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Base.ETracker.get_average_gaze(fallback_offscreen<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Compute smoothed gaze position from recent samples.</p>
<p>Averages valid gaze coordinates from rolling buffer to provide stable gaze estimates for real-time applications. Handles missing or invalid data gracefully.</p>
<section id="parameters-2" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-2">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 5%">
<col style="width: 74%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>fallback_offscreen</td>
<td>bool</td>
<td>Return offscreen position if no valid data available. Default True (returns position far outside screen bounds).</td>
<td><code>True</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-1" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-1">Returns</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 5%">
<col style="width: 10%">
<col style="width: 83%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>tuple or None</td>
<td>Average gaze position (x, y) in Tobii ADCS coordinates, offscreen position, or None if no data and fallback disabled.</td>
</tr>
</tbody>
</table>
</section>
<section id="raises-1" class="level4 doc-section doc-section-raises">
<h4 class="doc-section doc-section-raises anchored" data-anchor-id="raises-1">Raises</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 16%">
<col style="width: 74%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>RuntimeError</td>
<td>If gaze_contingent() was not called first to initialize buffer.</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-1" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-1">Examples</h4>
<p>pos = tracker.get_average_gaze() if pos is not None: psychopy_pos = Coords.get_psychopy_pos(win, pos)</p>
</section>
</section>
<section id="DeToX.Base.ETracker.get_info" class="level3">
<h3 class="anchored" data-anchor-id="DeToX.Base.ETracker.get_info">get_info</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Base.ETracker.get_info(moment<span class="op">=</span><span class="st">'connection'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Displays information about the connected eye tracker or simulation settings.</p>
<p>This method prints a formatted summary of the hardware or simulation configuration. It can be called at different moments (e.g., at connection or before recording) to show relevant information. The information is retrieved from the eye tracker or simulation settings and cached on the first call to avoid repeated hardware queries.</p>
<section id="parameters-3" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-3">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 91%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>moment</td>
<td>str</td>
<td>Specifies the context of the information display. - ‘connection’: Shows detailed information, including all available options (e.g., frequencies, illumination modes). This is typically used right after initialization. - ‘recording’: Shows a concise summary of the settings being used for the current recording session. Default is ‘connection’.</td>
<td><code>'connection'</code></td>
</tr>
</tbody>
</table>
</section>
<section id="examples-2" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-2">Examples</h4>
</section>
</section>
</section>
</section>
<section id="after-connecting-to-the-tracker" class="level1">
<h1>After connecting to the tracker</h1>
<p>tracker.get_info(moment=‘connection’) # &gt;&gt; Eyetracker Info # &gt;&gt; Connected to the eyetracker: # &gt;&gt; - Model: Tobii Pro Spectrum # &gt;&gt; - Current frequency: 120.0 Hz # &gt;&gt; …</p>
</section>
<section id="just-before-starting-to-record-data" class="level1">
<h1>Just before starting to record data</h1>
<p>tracker.get_info(moment=‘recording’) # &gt;&gt; Recording Info # &gt;&gt; Starting recording with: # &gt;&gt; - Model: Tobii Pro Spectrum # &gt;&gt; - Current frequency: 120.0 Hz # &gt;&gt; …</p>
<section id="DeToX.Base.ETracker.load_calibration" class="level3">
<h3 class="anchored" data-anchor-id="DeToX.Base.ETracker.load_calibration">load_calibration</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Base.ETracker.load_calibration(filename<span class="op">=</span><span class="va">None</span>, use_gui<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Loads calibration data from a file and applies it to the eye tracker.</p>
<p>This method allows reusing a previously saved calibration, which can save significant time for participants, especially in multi-session studies. The calibration data must be a binary file generated by a Tobii eye tracker, typically via the <code>save_calibration()</code> method. This operation is only available when connected to a physical eye tracker.</p>
<section id="parameters-4" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-4">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 87%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>filename</td>
<td>str</td>
<td>The path to the calibration data file (e.g., “subject_01_calib.dat”). If <code>use_gui</code> is <code>True</code>, this path is used as the default suggestion in the file dialog. If <code>use_gui</code> is <code>False</code>, this parameter is required.</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td>use_gui</td>
<td>bool</td>
<td>If <code>True</code>, a graphical file-open dialog is displayed for the user to select the calibration file. Defaults to <code>False</code>.</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-2" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-2">Returns</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 91%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>bool</td>
<td>Returns <code>True</code> if the calibration was successfully loaded and applied, and <code>False</code> otherwise (e.g., user cancelled the dialog, file not found, or data was invalid).</td>
</tr>
</tbody>
</table>
</section>
<section id="raises-2" class="level4 doc-section doc-section-raises">
<h4 class="doc-section doc-section-raises anchored" data-anchor-id="raises-2">Raises</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>RuntimeError</td>
<td>If the method is called while the ETracker is in simulation mode.</td>
</tr>
<tr class="even">
<td></td>
<td>ValueError</td>
<td>If <code>use_gui</code> is <code>False</code> and <code>filename</code> is not provided.</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="DeToX.Base.ETracker.record_event" class="level3">
<h3 class="anchored" data-anchor-id="DeToX.Base.ETracker.record_event">record_event</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>Base.ETracker.record_event(label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Record timestamped experimental event during data collection.</p>
<p>Events are merged with gaze data based on timestamp proximity during save operations. Uses appropriate timing source for simulation vs.&nbsp;real eye tracker modes.</p>
<section id="parameters-5" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-5">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 72%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>label</td>
<td>str</td>
<td>Descriptive label for the event (e.g., ‘trial_start’, ‘stimulus_onset’).</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
</section>
<section id="raises-3" class="level4 doc-section doc-section-raises">
<h4 class="doc-section doc-section-raises anchored" data-anchor-id="raises-3">Raises</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>RuntimeWarning</td>
<td>If called when recording is not active.</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-3" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-3">Examples</h4>
<p>tracker.record_event(‘trial_1_start’) # … present stimulus … tracker.record_event(‘stimulus_offset’)</p>
</section>
</section>
<section id="DeToX.Base.ETracker.save_calibration" class="level3">
<h3 class="anchored" data-anchor-id="DeToX.Base.ETracker.save_calibration">save_calibration</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Base.ETracker.save_calibration(filename<span class="op">=</span><span class="va">None</span>, use_gui<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Save the current calibration data to a file.</p>
<p>Retrieves the active calibration data from the connected Tobii eye tracker and saves it as a binary file. This can be reloaded later with <code>load_calibration()</code> to avoid re-calibrating the same participant.</p>
<section id="parameters-6" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-6">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 87%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>filename</td>
<td>str | None</td>
<td>Desired output path. If None and <code>use_gui</code> is False, a timestamped default name is used (e.g., ‘YYYY-mm-dd_HH-MM-SS_calibration.dat’). If provided without an extension, ‘.dat’ is appended. If an extension is already present, it is left unchanged.</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td>use_gui</td>
<td>bool</td>
<td>If True, opens a file-save dialog (Psychopy) where the user chooses the path. The suggested name respects the logic above. Default False.</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-3" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-3">Returns</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 86%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>bool</td>
<td>True if saved successfully; False if cancelled, no data available, in simulation mode, or on error.</td>
</tr>
</tbody>
</table>
</section>
<section id="notes-1" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-1">Notes</h4>
<ul>
<li>In simulation mode, saving is skipped and a warning is issued.</li>
<li>If <code>use_gui</code> is True and the dialog is cancelled, returns False.</li>
</ul>
</section>
</section>
<section id="DeToX.Base.ETracker.save_data" class="level3">
<h3 class="anchored" data-anchor-id="DeToX.Base.ETracker.save_data">save_data</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Base.ETracker.save_data()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Save buffered gaze and event data to file with optimized processing.</p>
<p>Uses thread-safe buffer swapping to minimize lock time, then processes and saves data in CSV or HDF5 format. Events are merged with gaze data based on timestamp proximity.</p>
</section>
<section id="DeToX.Base.ETracker.show_status" class="level3">
<h3 class="anchored" data-anchor-id="DeToX.Base.ETracker.show_status">show_status</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>Base.ETracker.show_status(decision_key<span class="op">=</span><span class="st">'space'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Real-time visualization of participant’s eye position in track box.</p>
<p>Creates interactive display showing left/right eye positions and distance from screen. Useful for positioning participants before data collection. Updates continuously until exit key is pressed.</p>
<section id="parameters-7" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-7">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 9%">
<col style="width: 62%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>decision_key</td>
<td>str</td>
<td>Key to press to exit visualization. Default ‘space’.</td>
<td><code>'space'</code></td>
</tr>
</tbody>
</table>
</section>
<section id="notes-2" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-2">Notes</h4>
<p>In simulation mode, use scroll wheel to adjust simulated distance. Eye positions shown as green (left) and red (right) circles.</p>
</section>
</section>
<section id="DeToX.Base.ETracker.start_recording" class="level3">
<h3 class="anchored" data-anchor-id="DeToX.Base.ETracker.start_recording">start_recording</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Base.ETracker.start_recording(filename<span class="op">=</span><span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Begin gaze data recording session.</p>
<p>Initializes file structure, clears any existing buffers, and starts data collection from either the eye tracker or simulation mode. Creates HDF5 or CSV files based on filename extension.</p>
<section id="parameters-8" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-8">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 84%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>filename</td>
<td>str</td>
<td>Output filename for gaze data. If None, generates timestamp-based name. File extension determines format (.h5/.hdf5 for HDF5, .csv for CSV, defaults to .h5).</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="raises-4" class="level4 doc-section doc-section-raises">
<h4 class="doc-section doc-section-raises anchored" data-anchor-id="raises-4">Raises</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>UserWarning</td>
<td>If recording is already in progress.</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="DeToX.Base.ETracker.stop_recording" class="level3">
<h3 class="anchored" data-anchor-id="DeToX.Base.ETracker.stop_recording">stop_recording</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Base.ETracker.stop_recording()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Stop gaze data recording and finalize session.</p>
<p>Performs complete shutdown: stops data collection, cleans up resources, saves all buffered data, and reports session summary. Handles both simulation and real eye tracker modes appropriately.</p>
<section id="raises-5" class="level4 doc-section doc-section-raises">
<h4 class="doc-section doc-section-raises anchored" data-anchor-id="raises-5">Raises</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>UserWarning</td>
<td>If recording is not currently active.</td>
</tr>
</tbody>
</table>
</section>
<section id="notes-3" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-3">Notes</h4>
<p>All pending data in buffers is automatically saved before completion. Recording duration is measured from start_recording() call.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>